<div class="container">
  <form (ngSubmit)="onSubmit()" ngNativeValidate>
    <div class="row">
      <h4>โครงการใหม่</h4>
      <div class="input-group input-group-icon">
        <input
          type="text"
          [(ngModel)]="project.name"
          name="name"
          placeholder="ชื่อโครงการ"
          required
        />
        <div class="input-icon"><i class="fa fa-user"></i></div>
      </div>
      <div class="input-group input-group-icon">
        <input
          type="text"
          [(ngModel)]="project.detail"
          name="detail"
          placeholder="รายละเอียดของโครงการ"
        />
        <div class="input-icon"><i class="fa fa-envelope"></i></div>
      </div>
    </div>
    <div class="row">
      <div class="col-half">
        <h4>วันเริ่มโครงการ</h4>
        <div class="input-group">
          <input
            type="date"
            [(ngModel)]="project.startDate"
            name="startdate"
            placeholder="Date Start Project"
            required
          />
        </div>
      </div>
      <div class="col-half">
        <h4>วันสิ้นสุดโครงการ</h4>
        <div class="input-group">
          <input
            type="date"
            [(ngModel)]="project.endDate"
            name="enddate"
            placeholder="Date End Project"
            required
          />
        </div>
      </div>
    </div>
    <div class="row">
      <h4>กิจกรรมโครงการ</h4>
      <div class="container">
        <div class="row">
          <table class="mb-3">
            <thead>
              <tr class="text-center">
                <th colspan="3">Activity Name</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody class="text-center">
              <ng-container
                *ngTemplateOutlet="recursiveListTmpl; context:{ list: project.activities, level: 1 }"
              ></ng-container>
            </tbody>
          </table>
          <div class="row">
            <div class="col-half">
              <button
                type="button"
                (click)="addParentActivity()"
                class="button"
              >
                เพิ่มกิจกรรมแม่
                <svg fill="currentColor" viewBox="0 0 24 24" class="icon">
                  <path
                    clip-rule="evenodd"
                    d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm4.28 10.28a.75.75 0 000-1.06l-3-3a.75.75 0 10-1.06 1.06l1.72 1.72H8.25a.75.75 0 000 1.5h5.69l-1.72 1.72a.75.75 0 101.06 1.06l3-3z"
                    fill-rule="evenodd"
                  ></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
      <div class="col-half">
        <button type="submit" class="button mt-3">
          บันทึกข้อมูลโครงการ
          <svg fill="currentColor" viewBox="0 0 24 24" class="icon">
            <path
              clip-rule="evenodd"
              d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm4.28 10.28a.75.75 0 000-1.06l-3-3a.75.75 0 10-1.06 1.06l1.72 1.72H8.25a.75.75 0 000 1.5h5.69l-1.72 1.72a.75.75 0 101.06 1.06l3-3z"
              fill-rule="evenodd"
            ></path>
          </svg>
        </button>
      </div>

      <ng-template #recursiveListTmpl let-list="list" let-level="level">
        <ng-container *ngFor="let item of list; let i = index">
          <tr>
            <td *ngFor="let l of forfirsttd(item.lv)"></td>
            <td>
              <input
                [(ngModel)]="item.name"
                [ngModelOptions]="{standalone:true}"
                placeholder="ชื่อกิจกรรม"
                required
              />
            </td>
            <td *ngFor="let l of forlasttd(item.lv)"></td>
            <td>
              <button
                type="button"
                *ngIf="level < 3"
                (click)="addChildActivity(item)"
                class="btn btn-warning ms-3"
              >
                เพิ่มกิจกรรมลูก
              </button>
              <button
                type="button"
                (click)="deleteInverseActivity(i,item)"
                class="btn btn-danger ms-3"
              >
                ลบกิจกรรมนี้
              </button>
            </td>
          </tr>
          <ng-container
            *ngTemplateOutlet="recursiveListTmpl; context:{ list: item.inverseActivityHeader, level: level + 1 }"
          ></ng-container>
        </ng-container>
      </ng-template>
    </div>
  </form>
</div>
